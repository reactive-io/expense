//= require moment
//= require jquery
//= require jquery_ujs
//= require bootstrap-datetimepicker
//= require bootstrap-sprockets
//= require angular-1.3.0-beta.min
//= require angular-route-1.3.0-beta.min

//= require ./configs/ngRails
//= require ./configs/datetimepicker
//= require ./configs/angular

//= require ./modules/navigation
//= require ./modules/forms

//= require ./controllers/expenses
//= require ./controllers/tests

//= require_self

(function() {
  "use strict";

  var app = angular.module('application', ['ngRails', 'ngRoute', 'myNavigation', 'myForms', 'controllers']);

  app.config(['$routeProvider', function($routeProvider) {
    $routeProvider.
      when('/expenses', {
        templateUrl: '<%= asset_path('expenses/index.html') %>',
        controller: 'ExpensesController'
      }).
      when('/tests', {
        templateUrl: '<%= asset_path('tests/index.html') %>',
        controller: 'TestsController'
      }).
      when('/tests/:id', {
        templateUrl: '<%= asset_path('tests/show.html') %>',
        controller: 'TestsController'
      }).
      otherwise({
        redirectTo: '/expenses'
      });
    }]);

  app.run(['$rootScope', '$location', function($rootScope, $location) {
    $rootScope.
      $on('$routeChangeStart', function(event, next, current) {
        // prevents bootstrap datetimepicker from leaving unwanted dropdown menus lying around.
        $('body > div.bootstrap-datetimepicker-widget.dropdown-menu').remove();
      });
  }]);
})();
